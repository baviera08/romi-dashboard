(this["webpackJsonpromi-dashboard"]=this["webpackJsonpromi-dashboard"]||[]).push([[0],{119:function(e,t,a){},124:function(e,t,a){},125:function(e,t,a){"use strict";a.r(t);a(97);var n=a(0),r=a.n(n),o=a(18),i=a.n(o),c=a(7),l=a.n(c),s=a(15),u=(a(103),a(23)),f=a(22),m=a(83),d=function(){function e(){Object(u.a)(this,e)}return Object(f.a)(e,[{key:"latestTrajectory",value:function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("L1"!==t.param.map_name){e.next=2;break}return e.abrupt("return",JSON.parse(JSON.stringify(m)));case 2:return e.abrupt("return",{response:"trajectory",values:[]});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"serverTime",value:function(e){throw new Error("Method not implemented.")}}]),e}(),p=a(37),b=a(33),v=a(32),E=a(3),h=a(36),g=a.n(h),O=a(84);function y(){for(var e=[],t=1;t<=20;t++)e.push({name:"Geth".concat(t),model:"TeRmInAtOr",mode:{mode:E.RobotMode.MODE_MOVING},location:{level_name:"L1",x:t,y:-2,yaw:.1*t%2*Math.PI,t:{sec:0,nanosec:0}},battery_percent:100,path:[],task_id:"taskA"});return{name:"SuperFleet",robots:e}}var _=function(e){Object(b.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).name="fake",e}return Object(f.a)(a,[{key:"createPublisher",value:function(e,t){return{publish:g.a.log}}},{key:"subscribe",value:function(e,t,a){switch(g.a.log("subscribe:",e),e){case E.doorStates:var n={Door1:{door_name:"main_door",current_mode:{value:E.DoorMode.MODE_OPEN},door_time:{sec:0,nanosec:0}},Door2:{door_name:"hardware_door",current_mode:{value:E.DoorMode.MODE_CLOSED},door_time:{sec:0,nanosec:0}}};setInterval((function(){for(var e=0,a=Object.values(n);e<a.length;e++){var r=a[e];t(r)}}),1e3);break;case E.liftStates:var r={Lift1:{lift_name:"Lift1",available_floors:["L1","L2","L3"],available_modes:new Uint8Array([E.LiftState.MODE_AGV]),current_floor:"L1",current_mode:E.LiftState.MODE_AGV,destination_floor:"L1",door_state:E.LiftState.DOOR_OPEN,lift_time:{sec:0,nanosec:0},motion_state:E.LiftState.MOTION_STOPPED,session_id:""},Lift2:{lift_name:"Lift2",available_floors:["L1","L2","L3","L4"],available_modes:new Uint8Array([E.LiftState.MODE_AGV]),current_floor:"L2",current_mode:E.LiftState.MODE_AGV,destination_floor:"L4",door_state:E.LiftState.DOOR_CLOSED,lift_time:{sec:0,nanosec:0},motion_state:E.LiftState.MOTION_UP,session_id:""}};setInterval((function(){for(var e=0,a=Object.values(r);e<a.length;e++){var n=a[e];t(n)}}),1e3);break;case E.fleetStates:var o=[{name:"Fleet1",robots:[{name:"RobotA",model:"ModelA",mode:{mode:E.RobotMode.MODE_MOVING},location:{level_name:"L1",x:2,y:-5,yaw:0,t:{sec:0,nanosec:0}},battery_percent:100,path:[],task_id:"taskA"},{name:"RobotB",model:"ModelB",mode:{mode:E.RobotMode.MODE_WAITING},location:{level_name:"L1",x:12,y:-10,yaw:0,t:{sec:0,nanosec:0}},battery_percent:100,path:[],task_id:"taskB"}]},{name:"Fleet2",robots:[{name:"RobotC",model:"ModelC",mode:{mode:E.RobotMode.MODE_EMERGENCY},location:{level_name:"L2",x:4,y:-12,yaw:0,t:{sec:0,nanosec:0}},battery_percent:100,path:[],task_id:"taskC"}]},y()];setInterval((function(){var e,a=Object(p.a)(o);try{for(a.s();!(e=a.n()).done;){var n=e.value;t(n)}}catch(r){a.e(r)}finally{a.f()}}),1e3);break;case E.dispenserStates:var i={Dispenser0:{time:{sec:0,nanosec:0},guid:"Dispenser0",mode:0,request_guid_queue:[],seconds_remaining:0},Dispenser1:{time:{sec:0,nanosec:0},guid:"Dispenser1",mode:1,request_guid_queue:["Request0","Request1","Request2","Request3","Request4","Request5","Request6","Request7","Request8","Request9"],seconds_remaining:420},Dispenser2:{time:{sec:0,nanosec:0},guid:"Dispenser2",mode:2,request_guid_queue:[],seconds_remaining:0}};setInterval((function(){for(var e=0,a=Object.values(i);e<a.length;e++){var n=a[e];t(n)}}),1e3)}return{unsubscribe:function(){}}}},{key:"call",value:function(){var e=Object(s.a)(l.a.mark((function e(t,a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("get_building_map"!==t.service){e.next=6;break}return e.t0=E.GetBuildingMap_Response,e.next=4,Object(O.a)();case 4:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 6:throw new Error("not implemented");case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){}}]),a}(E.TransportEvents),w=a(9);function x(e){var t,a=[],n=Object(p.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,o=Object(w.a)(r.x,3),i=o[0],c=o[1],l=o[2],s=Object(w.a)(r.v,3),u=s[0],f=s[1],m=s[2];a.push({pose:{x:i,y:c,theta:l},velocity:{x:u,y:f,theta:m},time:r.t})}}catch(d){n.e(d)}finally{n.f()}return a}var j,S,k={transportFactory:function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new _);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),trajectoryManagerFactory:function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new d);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},C=a(163),L=a(179),D=a(180),M=a(56),N=a(126),R=a(130),I=a(181),P=a(182),F=(a(118),a(13)),A=a(38),B=a.n(A),T=function(e){Object(b.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r)))._doorStates={},e}return Object(f.a)(a,[{key:"doorStates",value:function(){return Object(F.a)({},this._doorStates)}},{key:"startSubscription",value:function(e){var t=this;e.subscribe(E.doorStates,(function(e){t._doorStates[e.door_name]=e,t.emit("updated")}))}}]),a}(B.a),U=function(e){Object(b.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r)))._fleets={},e}return Object(f.a)(a,[{key:"fleets",value:function(){return Array.from(Object.values(this._fleets))}},{key:"startSubscription",value:function(e){var t=this;e.subscribe(E.fleetStates,(function(e){t._fleets[e.name]=e,t.emit("updated")}))}}]),a}(B.a),q=function(e){Object(b.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r)))._liftStates={},e}return Object(f.a)(a,[{key:"liftStates",value:function(){return Object(F.a)({},this._liftStates)}},{key:"startSubscription",value:function(e){var t=this;e.subscribe(E.liftStates,(function(e){t._liftStates[e.lift_name]=e,t.emit("updated")}))}}]),a}(B.a),G=function(e){Object(b.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r)))._dispenserStates={},e}return Object(f.a)(a,[{key:"dispenserStates",value:function(){return Object(F.a)({},this._dispenserStates)}},{key:"startSubscription",value:function(e){var t=this;e.subscribe(E.dispenserStates,(function(e){t._dispenserStates[e.guid]=e,t.emit("updated")}))}}]),a}(B.a);function V(){return{trajectoryAnimation:j.Follow,trajectoryAnimationSpeed:S.Normal}}!function(e){e[e.None=0]="None",e[e.Fill=1]="Fill",e[e.Follow=2]="Follow",e[e.Outline=3]="Outline"}(j||(j={})),function(e){e[e.Slow=0]="Slow",e[e.Normal=1]="Normal",e[e.Fast=2]="Fast"}(S||(S={}));var W=r.a.createContext(V()),z=(a(119),a(19)),Y=a(16),H=a(31),J=a(184),K=a(158),Q=a(160),Z=a(161),X=a(162),$=a(127),ee=a(159),te=r.a.forwardRef((function(e,t){var a=e.door,n=e.doorState,o=e.enableControls,i=e.onOpenClick,c=e.onCloseClick,l=Object(Y.a)(e,["door","doorState","enableControls","onOpenClick","onCloseClick"]),s=ae(),u=Object(H.a)();return r.a.createElement(J.a,Object.assign({ref:t},l),r.a.createElement(K.a,{classes:{content:s.expansionSummaryContent},expandIcon:r.a.createElement(ee.a,null)},r.a.createElement(M.a,{variant:"h5"},a.name),r.a.createElement(M.a,{className:function(e){if(!e)return"";switch(e.current_mode.value){case E.DoorMode.MODE_OPEN:return"".concat(s.doorLabel," ").concat(s.doorLabelOpen);case E.DoorMode.MODE_CLOSED:return"".concat(s.doorLabel," ").concat(s.doorLabelClosed);case E.DoorMode.MODE_MOVING:return"".concat(s.doorLabel," ").concat(s.doorLabelMoving);default:return""}}(n),variant:"button"},function(e){if(!e)return"UNKNOWN";switch(e.current_mode.value){case E.DoorMode.MODE_OPEN:return"OPEN";case E.DoorMode.MODE_CLOSED:return"CLOSED";case E.DoorMode.MODE_MOVING:return"MOVING";default:return"UNKNOWN"}}(n))),r.a.createElement(Q.a,{className:s.expansionDetail},r.a.createElement("div",{className:s.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Type:"),r.a.createElement(M.a,{variant:"body1"},function(e){switch(e){case E.Door.DOOR_TYPE_DOUBLE_SLIDING:return"Double Sliding";case E.Door.DOOR_TYPE_DOUBLE_SWING:return"Double Swing";case E.Door.DOOR_TYPE_DOUBLE_TELESCOPE:return"Double Telescope";case E.Door.DOOR_TYPE_SINGLE_SLIDING:return"Sliding";case E.Door.DOOR_TYPE_SINGLE_TELESCOPE:return"Telescope";default:return"Unknown (".concat(e,")")}}(a.door_type))),r.a.createElement(Z.a,null),r.a.createElement("div",{className:s.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Motion Direction:"),r.a.createElement(M.a,{variant:"body1"},function(e){switch(e){case 1:return"Clockwise";case-1:return"Anti-Clockwise";default:return"Unknown (".concat(e,")")}}(a.motion_direction))),r.a.createElement(Z.a,null),r.a.createElement("div",{className:s.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Motion Range:"),r.a.createElement(M.a,{variant:"body1"},a.motion_range)),r.a.createElement(Z.a,null),r.a.createElement("div",{className:s.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Location:"),r.a.createElement(M.a,{variant:"body1"},"(",a.v1_x.toFixed(3),", ",a.v1_y.toFixed(3),")")),r.a.createElement(X.a,{style:{marginTop:u.spacing(1)},fullWidth:!0,disabled:!o},r.a.createElement($.a,{onClick:function(){return c&&c(a)}},"Close"),r.a.createElement($.a,{onClick:function(){return i&&i(a)}},"Open"))))})),ae=Object(C.a)((function(e){return{expansionSummaryContent:{alignItems:"center",justifyContent:"space-between"},expansionDetail:{flexFlow:"column"},expansionDetailLine:{display:"inline-flex",justifyContent:"space-between",padding:e.spacing(.5)},doorLabel:{borderRadius:e.shape.borderRadius,borderStyle:"solid",border:2,padding:5,width:"4rem",textAlign:"center"},doorLabelOpen:{borderColor:e.palette.success.main},doorLabelClosed:{borderColor:e.palette.error.main},doorLabelMoving:{borderColor:e.palette.warning.main}}}));function ne(e){var t=e.transport,a=e.spotlight,n=e.onDoorClick,o=r.a.useRef({}),i=r.a.useState({}),c=Object(w.a)(i,2),l=c[0],s=c[1],u=r.a.useMemo((function(){return t?t.createPublisher(E.doorRequests):null}),[t]);function f(e,a){null===u||void 0===u||u.publish({door_name:e.name,requested_mode:{value:a},requester_id:t.name,request_time:E.toRosTime(new Date)})}r.a.useEffect((function(){if(a){var e=o.current[a.value];e&&(s((function(e){return Object(F.a)({},e,Object(z.a)({},a.value,!0))})),e.scrollIntoView({behavior:"smooth"}))}}),[a]);var m=e.doors.map((function(a){var i=e.doorStates[a.name];return r.a.createElement(te,{key:a.name,ref:function(e){return o.current[a.name]=e},door:a,doorState:i,enableControls:Boolean(t),onOpenClick:function(){return f(a,E.DoorMode.MODE_OPEN)},onCloseClick:function(){return f(a,E.DoorMode.MODE_CLOSED)},onClick:function(){return n&&n(a)},expanded:Boolean(l[a.name]),onChange:function(e,t){return s((function(e){return Object(F.a)({},e,Object(z.a)({},a.name,t))}))}})}));return r.a.createElement(r.a.Fragment,null,m)}var re=a(128),oe=a(164),ie=a(186),ce=a(165),le=a(4),se=Object(C.a)((function(e){return{disabled:{color:e.palette.action.disabled}}}));function ue(e){var t,a=e.className,n=e.disabled,o=Object(Y.a)(e,["className","disabled"]),i=se();return r.a.createElement(M.a,Object.assign({className:Object(le.a)((t={},Object(z.a)(t,i.disabled,n),Object(z.a)(t,"className",a),t))},o),e.children)}var fe=r.a.forwardRef((function(e,t){var a=e.lift,n=e.liftState,o=e.enableRequest,i=e.onRequest,c=Object(Y.a)(e,["lift","liftState","enableRequest","onRequest"]),l=Object(H.a)(),s=me(),u=r.a.useState(null),f=Object(w.a)(u,2),m=f[0],d=f[1];function p(e){var t=e.map((function(e){return r.a.createElement(re.a,{key:e,dense:!0,className:s.noPadding},r.a.createElement(M.a,{variant:"body1"},e))}));return r.a.createElement(oe.a,null,t)}return r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,Object.assign({ref:t},c),r.a.createElement(K.a,{classes:{content:s.expansionSummaryContent},expandIcon:r.a.createElement(ee.a,null)},r.a.createElement(M.a,{variant:"h5"},a.name),r.a.createElement(M.a,{className:function(e){if(!e)return s.liftFloorLabelUnknown;switch(e.motion_state){case E.LiftState.MOTION_UP:case E.LiftState.MOTION_DOWN:return s.liftFloorLabelMoving;default:return s.liftFloorLabelStopped}}(n),variant:"button"},n?n.current_floor:"Unknown")),r.a.createElement(Q.a,{className:s.expansionDetail},r.a.createElement("div",{className:s.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Location:"),r.a.createElement(M.a,{variant:"body1"},"(".concat(a.ref_x.toFixed(3),", ").concat(a.ref_y.toFixed(3),")"))),r.a.createElement("div",{className:s.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Destination Floor:"),r.a.createElement(ue,{disabled:!n,variant:"body1"},n?n.destination_floor:"Unknown")),r.a.createElement(Z.a,null),r.a.createElement("div",{className:s.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Available Floors:"),function(e){return e?p(e.available_floors):r.a.createElement(ue,{disabled:!e,variant:"body1"},"Unknown")}(n)),r.a.createElement(Z.a,null),r.a.createElement("div",{className:s.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Current Mode:"),r.a.createElement(ue,{disabled:!n,variant:"body1"},n?de(n.current_mode):"Unknown")),r.a.createElement(Z.a,null),r.a.createElement("div",{className:s.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Available Modes:"),function(e){return e?p(Array.from(e.available_modes.values()).map(de)):r.a.createElement(ue,{disabled:!e,variant:"body1"},"Unknown")}(n)),r.a.createElement(Z.a,null),r.a.createElement("div",{className:s.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Door State:"),r.a.createElement(ue,{disabled:!n,variant:"body1"},n?function(e){switch(e){case E.LiftState.DOOR_OPEN:return"Open";case E.LiftState.DOOR_CLOSED:return"Closed";case E.LiftState.DOOR_MOVING:return"Moving";default:return"Unknown (".concat(e,")")}}(n.door_state):"Unknown")),r.a.createElement(Z.a,null),r.a.createElement("div",{className:s.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Motion State:"),r.a.createElement(ue,{disabled:!n,variant:"body1"},n?function(e){switch(e){case E.LiftState.MOTION_DOWN:return"Down";case E.LiftState.MOTION_STOPPED:return"Stopped";case E.LiftState.MOTION_UP:return"Up";default:return"Unknown (".concat(e,")")}}(n.motion_state):"Unknown")),r.a.createElement($.a,{variant:"outlined",style:{marginTop:l.spacing(1)},onClick:function(e){return function(e,t){d({lift:t,anchor:{top:e.clientY,left:e.clientX}})}(e,a)},disabled:!o,fullWidth:!0},"Request"))),m&&r.a.createElement(ie.a,{anchorReference:"anchorPosition",anchorPosition:null===m||void 0===m?void 0:m.anchor,open:Boolean(m),onClose:function(){return d(null)}},m&&a.levels.map((function(e){return r.a.createElement(ce.a,{key:e,onClick:function(){i&&i(a,e),d(null)}},e)}))))})),me=Object(C.a)((function(e){var t={borderRadius:e.shape.borderRadius,borderStyle:"solid",border:2,padding:5,width:"4rem",textAlign:"center"};return{expansionSummaryContent:{alignItems:"center",justifyContent:"space-between"},expansionDetail:{flexFlow:"column"},expansionDetailLine:{display:"inline-flex",justifyContent:"space-between",padding:e.spacing(.5)},noPadding:{padding:0},liftFloorLabelStopped:Object(F.a)({},t,{borderColor:e.palette.info.main}),liftFloorLabelMoving:Object(F.a)({},t,{borderColor:e.palette.warning.main}),liftFloorLabelUnknown:Object(F.a)({},t,{borderStyle:"none"})}}));function de(e){switch(e){case E.LiftState.MODE_AGV:return"AGV";case E.LiftState.MODE_EMERGENCY:return"Emergency";case E.LiftState.MODE_FIRE:return"Fire";case E.LiftState.MODE_HUMAN:return"Human";default:return"Unknown (".concat(e,")")}}function pe(e){var t=e.transport,a=e.spotlight,n=e.onLiftRequest,o=e.onLiftClick,i=r.a.useMemo((function(){return t?t.createPublisher(E.liftRequests):null}),[t]),c=r.a.useRef({}),l=r.a.useState({}),s=Object(w.a)(l,2),u=s[0],f=s[1];function m(e,a){null===i||void 0===i||i.publish({lift_name:e.name,door_state:E.LiftRequest.DOOR_OPEN,request_type:E.LiftRequest.REQUEST_AGV_MODE,request_time:E.toRosTime(new Date),destination_floor:a,session_id:t.name}),n&&n(e,a)}return r.a.useEffect((function(){if(a){var e=c.current[a.value];e&&(f((function(e){return Object(F.a)({},e,Object(z.a)({},a.value,!0))})),e.scrollIntoView({behavior:"smooth"}))}}),[a]),r.a.createElement(r.a.Fragment,null,e.lifts.map((function(a){var n=e.liftStates[a.name];return r.a.createElement(fe,{key:a.name,lift:a,liftState:n,enableRequest:Boolean(t),onRequest:m,onClick:function(){return o&&o(a)},expanded:Boolean(u[a.name]),onChange:function(e,t){return f((function(e){return Object(F.a)({},e,Object(z.a)({},a.name,t))}))}})})))}var be=a(129),ve=a(166),Ee=a(167),he=a(168),ge=Object(C.a)((function(e){return{root:{display:"flex",flexFlow:"column",justifyContent:"center",alignItems:"center",zIndex:e.zIndex.drawer+1},caption:{marginTop:e.spacing(4)}}}));function Oe(e){var t=Object(H.a)(),a=ge();return r.a.createElement(be.a,{className:a.root,open:!0},(void 0===e.variant||"loading"===e.variant)&&r.a.createElement(ve.a,{size:"8rem"}),"success"===e.variant&&r.a.createElement(Ee.a,{htmlColor:t.palette.success.main,style:{fontSize:"8rem"}}),"error"===e.variant&&r.a.createElement(he.a,{color:"error",style:{fontSize:"8rem"}}),r.a.createElement(M.a,{className:a.caption,variant:"button",style:{color:t.palette.getContrastText("#000000")}},e.caption))}function ye(e){return r.a.createElement(oe.a,null,r.a.createElement(re.a,{button:!0,onClick:e.onDoorsClick},r.a.createElement(M.a,{variant:"h5"},"Doors")),r.a.createElement(Z.a,null),r.a.createElement(re.a,{button:!0,onClick:e.onLiftsClick},r.a.createElement(M.a,{variant:"h5"},"Lifts")),r.a.createElement(Z.a,null),r.a.createElement(re.a,{button:!0,onClick:e.onRobotsClick},r.a.createElement(M.a,{variant:"h5"},"Robots")),r.a.createElement(Z.a,null),r.a.createElement(re.a,{button:!0,onClick:e.onPlacesClick},r.a.createElement(M.a,{variant:"h5"},"Places")),r.a.createElement(Z.a,null),r.a.createElement(re.a,{button:!0,onClick:e.onDispensersClick},r.a.createElement(M.a,{variant:"h5"},"Dispensers")))}var _e=a(169),we=a(170),xe=Object(C.a)((function(){return{container:{display:"flex",flexFlow:"column"},viewContainer:{height:"100%",overflowX:"hidden",position:"relative"}}})),je=r.a.forwardRef((function(e,t){e.view,e.classes,e.onBack,e.onClose,e.children;var a,n,o,i=Object(Y.a)(e,["view","classes","onBack","onClose","children"]),c=xe(),l="".concat(i.className||""," ").concat(c.container," ").concat(e.className);return r.a.createElement("div",Object.assign({},i,{ref:t,className:l}),r.a.createElement(X.a,{className:null===(a=e.classes)||void 0===a?void 0:a.navigation,variant:"text",fullWidth:!0},r.a.createElement($.a,{className:null===(n=e.classes)||void 0===n?void 0:n.backButton,size:"large",onClick:function(){e.onBack&&e.onBack(e.view)}},r.a.createElement(_e.a,null)),r.a.createElement($.a,{className:null===(o=e.classes)||void 0===o?void 0:o.closeButton,size:"large",onClick:function(){e.onClose&&e.onClose()}},r.a.createElement(we.a,null))),r.a.createElement("div",{className:c.viewContainer},e.children))})),Se=a(131),ke=Object(C.a)((function(){return{container:{width:"100%",height:"100%",position:"absolute"}}})),Ce=r.a.forwardRef((function(e,t){var a=ke(),n=e.value,o=e.index,i=e.children,c=n===o;return r.a.createElement(Se.a,{direction:"left",in:c,mountOnEnter:!0,unmountOnExit:!0,appear:!1},r.a.createElement("div",{className:a.container},i))})),Le=a(171),De=Object(C.a)((function(e){return{summary:{marginTop:0,marginBottom:0},details:{flexFlow:"column"},detailLine:{width:"100%",display:"inline-flex",justifyContent:"space-between",padding:e.spacing(.5)}}})),Me=r.a.forwardRef((function(e,t){var a=e.place,n=e.level,o=Object(Y.a)(e,["place","level"]),i=De();return r.a.createElement(J.a,Object.assign({ref:t},o),r.a.createElement(K.a,{expandIcon:r.a.createElement(ee.a,null)},r.a.createElement(Le.a,{className:i.summary,primary:a.name,primaryTypographyProps:{variant:"h5"},secondary:n.name})),r.a.createElement(Q.a,{className:i.details},r.a.createElement("div",{className:i.detailLine},r.a.createElement(M.a,null,"Location:"),r.a.createElement(M.a,null,"".concat(n.name," (").concat(a.x.toFixed(3),", ").concat(a.y.toFixed(3),", ").concat(a.yaw.toFixed(3),")"))),r.a.createElement(Z.a,null),r.a.createElement("div",{className:i.detailLine},r.a.createElement(M.a,null,"Position Tolerance:"),r.a.createElement(M.a,null,a.position_tolerance.toFixed(3))),r.a.createElement(Z.a,null),r.a.createElement("div",{className:i.detailLine},r.a.createElement(M.a,null,"Yaw Tolerance:"),r.a.createElement(M.a,null,a.yaw_tolerance.toFixed(3)))))}));function Ne(e){var t=e.buildingMap,a=e.spotlight,n=e.onPlaceClick,o=r.a.useRef({}),i=r.a.useState({}),c=Object(w.a)(i,2),l=c[0],s=c[1];return r.a.useEffect((function(){if(a){var e=o.current[a.value];e&&(s((function(e){return Object(F.a)({},e,Object(z.a)({},a.value,!0))})),e.scrollIntoView({behavior:"smooth"}))}}),[a]),r.a.createElement(r.a.Fragment,null,t.levels.flatMap((function(e){return e.places.map((function(t){return r.a.createElement(Me,{key:t.name,ref:function(e){return o.current[t.name]=e},place:t,level:e,onClick:function(){return n&&n(t)},expanded:Boolean(l[t.name]),onChange:function(e,a){return s((function(e){return Object(F.a)({},e,Object(z.a)({},t.name,a))}))}})}))})))}var Re=r.a.forwardRef((function(e,t){var a=e.robot,n=(e.onRobotClick,Object(Y.a)(e,["robot","onRobotClick"])),o=Ie();return r.a.createElement(J.a,Object.assign({ref:t},n),r.a.createElement(K.a,{classes:{content:o.expansionSummaryContent},expandIcon:r.a.createElement(ee.a,null)},r.a.createElement(M.a,{variant:"h5"},a.name),r.a.createElement(M.a,{className:o.robotStatusLabel,variant:"button"},function(e){switch(e.mode){case E.RobotMode.MODE_CHARGING:return"Charging";case E.RobotMode.MODE_DOCKING:return"Docking";case E.RobotMode.MODE_EMERGENCY:return"Emergency";case E.RobotMode.MODE_GOING_HOME:return"Going Home";case E.RobotMode.MODE_IDLE:return"Idle";case E.RobotMode.MODE_MOVING:return"Moving";case E.RobotMode.MODE_PAUSED:return"Paused";case E.RobotMode.MODE_WAITING:return"Waiting";default:return"Unknown (".concat(e.mode,")")}}(a.mode))),r.a.createElement(Q.a,{className:o.expansionDetail},r.a.createElement("div",{className:o.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Model:"),r.a.createElement(M.a,{variant:"body1"},a.model)),r.a.createElement(Z.a,null),r.a.createElement("div",{className:o.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Level:"),r.a.createElement(M.a,{variant:"body1"},a.location.level_name)),r.a.createElement(Z.a,null),r.a.createElement("div",{className:o.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Position:"),r.a.createElement(M.a,{variant:"body1"},"(".concat(a.location.x.toFixed(3),", ").concat(a.location.y.toFixed(3),")"))),r.a.createElement(Z.a,null),r.a.createElement("div",{className:o.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Yaw:"),r.a.createElement(M.a,{variant:"body1"},a.location.yaw.toFixed(3))),r.a.createElement(Z.a,null),r.a.createElement("div",{className:o.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Task Id:"),r.a.createElement(M.a,{variant:"body1",noWrap:!0},a.task_id)),r.a.createElement(Z.a,null),r.a.createElement("div",{className:o.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Battery:"),r.a.createElement(M.a,{variant:"body1"},a.battery_percent))))})),Ie=Object(C.a)((function(e){return{expansionSummaryContent:{alignItems:"center",justifyContent:"space-between"},expansionDetail:{flexFlow:"column"},expansionDetailLine:{display:"inline-flex",justifyContent:"space-between",padding:e.spacing(.5)},robotStatusLabel:{borderRadius:e.shape.borderRadius,borderStyle:"solid",borderColor:e.palette.info.main,border:2,padding:5,minWidth:"4rem",textAlign:"center"}}}));function Pe(e){var t=e.fleets,a=e.spotlight,n=e.onRobotClick,o=r.a.useRef({}),i=r.a.useState({}),c=Object(w.a)(i,2),l=c[0],s=c[1];return r.a.useEffect((function(){if(a){var e=o.current[a.value];e&&(s((function(e){return Object(F.a)({},e,Object(z.a)({},a.value,!0))})),e.scrollIntoView({behavior:"smooth"}))}}),[a]),r.a.createElement(r.a.Fragment,null,t.flatMap((function(e){return e.robots.map((function(e){return r.a.createElement(Re,{key:e.name,ref:function(t){return o.current[e.name]=t},robot:e,onClick:function(){return n&&n(e)},expanded:Boolean(l[e.name]),onChange:function(t,a){return s((function(t){return Object(F.a)({},t,Object(z.a)({},e.name,a))}))},TransitionProps:{unmountOnExit:!0}})}))})))}var Fe=r.a.forwardRef((function(e,t){var a=e.dispenserState,n=Object(Y.a)(e,["dispenserState"]),o=Ae(),i=Be();return r.a.createElement(J.a,Object.assign({ref:t},n),r.a.createElement(K.a,{classes:{content:o.expansionSummaryContent},expandIcon:r.a.createElement(ee.a,null)},r.a.createElement(M.a,{variant:"h5"},a.guid),r.a.createElement(M.a,{className:function(){switch(a.mode){case E.DispenserState.IDLE:return"".concat(o.dispenserLabel," ").concat(i.idle);case E.DispenserState.BUSY:return"".concat(o.dispenserLabel," ").concat(i.busy);case E.DispenserState.OFFLINE:return"".concat(o.dispenserLabel," ").concat(i.offline);default:return""}}(),variant:"button"},function(){switch(a.mode){case E.DispenserState.IDLE:return"IDLE";case E.DispenserState.BUSY:return"ONLINE";case E.DispenserState.OFFLINE:return"OFFLINE";default:return"UNKNOWN"}}())),r.a.createElement(Q.a,{className:o.expansionDetail},r.a.createElement("div",{className:o.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"No. Queued Requests:"),r.a.createElement(M.a,{variant:"body1"},String(a.request_guid_queue.length))),r.a.createElement(Z.a,null),r.a.createElement("div",{className:o.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Request Queue ID:"),r.a.createElement(oe.a,{className:o.listRoot,dense:!0},a.request_guid_queue.map((function(e){return r.a.createElement(re.a,{key:e},r.a.createElement(Le.a,{primary:e}))})))),r.a.createElement(Z.a,null),r.a.createElement("div",{className:o.expansionDetailLine},r.a.createElement(M.a,{variant:"body1"},"Seconds Remaining:"),r.a.createElement(M.a,{variant:"body1"},String(a.seconds_remaining)))))})),Ae=Object(C.a)((function(e){return{expansionSummaryContent:{alignItems:"center",justifyContent:"space-between"},expansionDetail:{flexFlow:"column"},expansionDetailLine:{display:"inline-flex",justifyContent:"space-between",padding:e.spacing(.5)},dispenserLabel:{borderRadius:e.shape.borderRadius,borderStyle:"solid",border:2,padding:5,width:"4rem",textAlign:"center"},listRoot:{position:"relative",overflow:"auto",maxHeight:100}}})),Be=Object(C.a)((function(e){var t={borderRadius:e.shape.borderRadius,borderStyle:"solid",border:2,padding:5,width:"4rem",textAlign:"center"};return{idle:Object(F.a)({},t,{borderColor:e.palette.warning.main}),busy:Object(F.a)({},t,{borderColor:e.palette.success.main}),offline:Object(F.a)({},t,{borderColor:e.palette.error.main})}}));function Te(e){var t=e.spotlight,a=r.a.useRef({}),n=r.a.useState({}),o=Object(w.a)(n,2),i=o[0],c=o[1];r.a.useEffect((function(){if(t){var e=a.current[t.value];e&&(c((function(e){return Object(F.a)({},e,Object(z.a)({},t.value,!0))})),e.scrollIntoView({behavior:"smooth"}))}}),[t]);var l=Object.keys(e.dispenserStates).map((function(t,n){var o=e.dispenserStates[t];return r.a.createElement(Fe,{key:o.guid,ref:function(e){return a.current[o.guid]=e},dispenserState:o,expanded:Boolean(i[o.guid]),onChange:function(e,t){return c((function(e){return Object(F.a)({},e,Object(z.a)({},o.guid,t))}))}})}));return r.a.createElement(r.a.Fragment,null,l)}var Ue=a(12),qe=a(173),Ge=a(174),Ve=a(175),We=a(187),ze=a(176);function Ye(e){var t=new Blob([e]);return URL.createObjectURL(t)}function He(e){return Je.apply(this,arguments)}function Je(){return(Je=Object(s.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new TextEncoder,n=a.encode(t),e.abrupt("return",crypto.subtle.digest("SHA-256",n));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ke=function(){function e(){Object(u.a)(this,e),this._robotColorCache={}}return Object(f.a)(e,[{key:"robotColor",value:function(){var e=Object(s.a)(l.a.mark((function e(t,a){var n,r,o,i,c,s,u,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._robotKey(t,a),r=this._robotColorCache[n]){e.next=19;break}return e.t0=Uint16Array,e.next=6,He(a);case 6:return e.t1=e.sent,o=new e.t0(e.t1),i=o[0]%360,e.t2=Uint16Array,e.next=12,He(t);case 12:e.t3=e.sent,c=new e.t2(e.t3),s=c[0]%2500,u=50+s%50,f=25+s/50,r="hsl(".concat(i,", ").concat(u,"%, ").concat(f,"%)"),this._robotColorCache[n]=r;case 19:return e.abrupt("return",r);case 20:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"robotColorFromCache",value:function(e,t){var a=this._robotColorCache[this._robotKey(e,t)];return a||null}},{key:"_robotKey",value:function(e,t){return"".concat(e,"__").concat(t)}}]),e}();var Qe=r.a.forwardRef((function(e,t){var a=e.place,n=e.size,o=e.onClick,i=Ze(),c=Object(H.a)();return r.a.createElement("g",{ref:t,onClick:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return o&&o(e,a)}))},r.a.createElement("rect",{className:i.placeMarker,x:a.x-.5*n,y:-a.y-.5*n,width:n,height:n,fill:c.palette.primary.main,opacity:.95}))})),Ze=Object(C.a)((function(){return{placeMarker:{cursor:"pointer",pointerEvents:"auto"}}})),Xe=a(172).a;function $e(e){e.places;var t=e.onPlaceClick,a=Object(Y.a)(e,["places","onPlaceClick"]),n=function(e){var t=e instanceof Ue.LatLngBounds?e:new Ue.LatLngBounds(e),a=t.getEast()-t.getWest(),n=t.getNorth()-t.getSouth();return"0 0 ".concat(a," ").concat(n)}(e.bounds);return r.a.createElement(Xe,a,r.a.createElement("svg",{viewBox:n},e.places.map((function(e){return r.a.createElement(Qe,{key:e.name,place:e,size:1,onClick:function(e,a){return t&&t(a)}})}))))}function et(e){var t=e.initialPose,a=e.finalPose,n=e.initialVelocity,r=e.finalVelocity,o=e.initialTime,i=e.finalTime-o,c=n/i,l=r/i;return{a:l+c-2*a+2*t,b:-l-2*c+3*a-3*t,c:c,d:t}}function tt(e,t,a){return{initialPose:e.pose[a],finalPose:t.pose[a],initialVelocity:e.velocity[a],finalVelocity:t.velocity[a],initialTime:e.time,finalTime:t.time}}function at(e){for(var t=[],a=0;a<e.length-1;++a){var n=e[a],r=e[a+1],o={x:et(tt(n,r,"x")),y:et(tt(n,r,"y")),theta:et(tt(n,r,"theta")),initialTime:n.time,finalTime:r.time};t.push(o)}return t}function nt(e){var t=e.a,a=e.b,n=e.c,r=e.d,o=(n+3*r)/3,i=(a-3*r+6*o)/3;return[r,o,i,t+r-3*o+3*i]}function rt(e){var t=nt(e.x),a=nt(e.y);return t.map((function(e,t){return[e,a[t]]}))}var ot=r.a.forwardRef((function(e,t){var a=e.trajectory,n=e.footprint,o=e.color,i=Object(Y.a)(e,["trajectory","footprint","color"]),c=r.a.useMemo((function(){var e=at(x(a.segments)).map(rt),t="M ".concat(e[0][0][0]," ").concat(-e[0][0][1]," C ");return e.map((function(e){return t+="".concat(e[1][0]," ").concat(-e[1][1]," ")+"".concat(e[2][0]," ").concat(-e[2][1]," ")+"".concat(e[3][0]," ").concat(-e[3][1]," ")})),t}),[a]);return r.a.createElement("path",Object.assign({ref:t,d:c,stroke:o,opacity:.8,strokeWidth:.8*n,strokeLinecap:"round",fill:"none",pathLength:1,strokeDasharray:2,strokeDashoffset:0},i))}));function it(e){var t=e.trajs,a=(e.colorManager,Object(Y.a)(e,["trajs","colorManager"])),n=r.a.useContext(ct),o=e.bounds instanceof Ue.LatLngBounds?e.bounds:new Ue.LatLngBounds(e.bounds),i=o.getEast()-o.getWest(),c=o.getNorth()-o.getSouth(),l="0 0 ".concat(i," ").concat(c);return r.a.createElement(Xe,a,r.a.createElement("svg",{viewBox:l},t.map((function(e){return r.a.createElement(n.Component,{key:e.id,trajectory:e,footprint:.5,color:"green"})}))))}var ct=r.a.createContext({Component:ot}),lt=Object(C.a)((function(){return{robotMarker:{cursor:"pointer",pointerEvents:"auto"}}})),st=r.a.forwardRef((function(e,t){var a=lt(),n=e.robot,o=e.footprint,i=e.colorManager,c=e.onClick,u=r.a.useState((function(){return i.robotColorFromCache(n.name,n.model)})),f=Object(w.a)(u,2),m=f[0],d=f[1],p=r.a.useMemo((function(){return[n.location.x+Math.cos(n.location.yaw)*o,n.location.y+Math.sin(n.location.yaw)*o]}),[n,o]);return r.a.useLayoutEffect((function(){m||Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=d,e.next=3,i.robotColor(n.name,n.model);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))()}),[n,m,i]),r.a.createElement("g",{ref:t,onClick:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return c&&c(e,n)}))},m&&r.a.createElement(r.a.Fragment,null,r.a.createElement("filter",{id:"".concat(n.name,"-shadow"),x:"-20%",y:"-20%",width:"140%",height:"140%"},r.a.createElement("feDropShadow",{dx:"0",dy:"0",stdDeviation:.15*o,floodColor:"black"})),r.a.createElement("circle",{className:a.robotMarker,onClick:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return c&&c(e,n)})),cx:n.location.x,cy:-n.location.y,r:o,fill:m,filter:"url(#".concat(n.name,"-shadow)")}),r.a.createElement("line",{x1:n.location.x,y1:-n.location.y,x2:p[0],y2:-p[1],stroke:"black",strokeWidth:"0.05"})))}));function ut(e){var t=e.robots,a=e.colorManager,n=e.onRobotClick,o=Object(Y.a)(e,["robots","colorManager","onRobotClick"]),i=e.bounds instanceof Ue.LatLngBounds?e.bounds:new Ue.LatLngBounds(e.bounds),c=i.getEast()-i.getWest(),l=i.getNorth()-i.getSouth(),s="0 0 ".concat(c," ").concat(l);return r.a.createElement(Xe,o,r.a.createElement("svg",{viewBox:s},t.map((function(e){return r.a.createElement(st,{key:e.name,robot:e,footprint:.5,colorManager:a,onClick:function(e,t){return n&&n(t)}})}))))}function ft(e){var t=e.segments,a=t[t.length-1].t-t[0].t;return e.segments.map((function(e){return(e.t-t[0].t)/a}))}var mt=Object(C.a)((function(){return{anim:{opacity:.8,strokeDasharray:2,strokeDashoffset:2},highlight:{opacity:.4}}})),dt=Object(C.a)((function(){return{anim:{opacity:.8,strokeDashoffset:2},highlight:{opacity:.4}}})),pt=Object(C.a)((function(){return{highlight:{opacity:.25},maskPath:{stroke:"black",opacity:1}}})),bt=Object(C.a)((function(){return{map:{height:"100%",width:"100%",margin:0,padding:0}}}));function vt(e){if(e.length){var t=new Ue.LatLngBounds([0,0],[0,0]);return Object.values(e).forEach((function(e){return t.extend(e.bounds)})),t.pad(.2)}}function Et(e){var t=bt(),a=r.a.useRef(null),n=a.current,o=r.a.useState({}),i=Object(w.a)(o,2),c=i[0],u=i[1],f=r.a.useMemo((function(){return e.buildingMap.levels.sort((function(e,t){return e.elevation-t.elevation})).map((function(e){return e.name}))}),[e.buildingMap]),m=r.a.useState((function(){return f[0]})),d=Object(w.a)(m,2),b=d[0],v=d[1],E=r.a.useMemo((function(){return c[b]}),[b,c]),h=r.a.useMemo((function(){var e=c[f[0]];if(e)return e.bounds}),[c,f]),g=r.a.useState((function(){return vt(Object.values(c))})),O=Object(w.a)(g,2),y=O[0],_=O[1],x=r.a.useMemo((function(){return E?e.fleets.flatMap((function(e){return e.robots.filter((function(e){return e.location.level_name===E.level.name}))})):[]}),[e.fleets,E]),k=r.a.useMemo((function(){return new Ke}),[]),C=r.a.useContext(W),L=r.a.useMemo((function(){switch(C.trajectoryAnimationSpeed){case S.Slow:return 4e3;case S.Normal:return 2e3;case S.Fast:return 1e3}}),[C]),D=r.a.useMemo((function(){switch(C.trajectoryAnimation){case j.None:return ot;case j.Fill:return function(e,t){return function(a){var n=mt(),o=a.trajectory,i=r.a.useRef(null);return r.a.useLayoutEffect((function(){var e;if(i.current){var a=ft(o),r=i.current.cloneNode(!1);return r.classList.add(n.anim),r.classList.remove(n.highlight),r.setAttribute("path-length","1"),null===(e=i.current.parentElement)||void 0===e||e.appendChild(r),r.animate(a.map((function(e){return{offset:e,strokeDashoffset:2-e}})),{duration:t,easing:"linear",fill:"forwards"}),function(){return r.remove()}}}),[o,n.anim,n.highlight]),r.a.createElement("g",null,r.a.createElement(e,Object.assign({ref:i},a,{className:n.highlight})))}}(ot,.8*L);case j.Follow:return function(e,t){return function(a){var n=dt(),o=a.trajectory,i=r.a.useRef(null);return r.a.useLayoutEffect((function(){var e;if(i.current){var a=ft(o),r=i.current.cloneNode(!1);r.classList.add(n.anim),r.classList.remove(n.highlight),r.setAttribute("path-length","1");var c=Number(r.getAttribute("stroke-width")||1)/r.getTotalLength();return r.setAttribute("stroke-dasharray","".concat(c," ").concat(2-c)),null===(e=i.current.parentElement)||void 0===e||e.appendChild(r),r.animate(a.map((function(e){return{offset:e,strokeDashoffset:Math.max(2-e,c+1)}})),{duration:t,easing:"linear",fill:"forwards"}),function(){return r.remove()}}}),[o,n.anim,n.highlight]),r.a.createElement("g",null,r.a.createElement(e,Object.assign({ref:i},a,{className:n.highlight})))}}(ot,.8*L);case j.Outline:return function(e,t){return function(a){var n=pt(),o=a.trajectory,i=r.a.useRef(null);return r.a.useLayoutEffect((function(){if(i.current&&i.current.parentElement){var e=ft(o),a=i.current.parentElement,r=document.createElementNS("http://www.w3.org/2000/svg","mask");r.setAttribute("id","".concat(o.id,"-mask"));var c=document.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("x","0"),c.setAttribute("y","0"),c.setAttribute("width","100%"),c.setAttribute("height","100%"),c.setAttribute("fill","white"),r.appendChild(c);var l=i.current.cloneNode(!1);l.classList.add(n.maskPath);var s=i.current.getAttribute("stroke-width");s&&l.setAttribute("stroke-width",(parseFloat(s)-.1).toString()),r.appendChild(l),a.appendChild(r);var u=i.current.cloneNode(!1);return u.removeAttribute("mask"),u.classList.add(n.highlight),a.appendChild(u),i.current.animate(e.map((function(e){return{offset:e,strokeDashoffset:2-e}})),{duration:t,easing:"linear",fill:"forwards"}),function(){u.remove(),r.remove()}}}),[o,n.highlight,n.maskPath]),r.a.createElement("g",null,r.a.createElement(e,Object.assign({ref:i},a,{mask:"url(#".concat(o.id,"-mask)")})))}}(ot,.8*L)}}),[C.trajectoryAnimation,L]);r.a.useEffect((function(){n&&Object(s.a)(l.a.mark((function t(){var a,n,r,o,i,c,s,f;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=[],n={},r=Object(p.a)(e.buildingMap.levels),t.prev=3,i=function(){var e=o.value,t=e.images[0];if(!t)return"continue";a.push(new Promise((function(a){var r=new Image,o=Ye(t.data);r.src=o;r.addEventListener("load",(function i(){r.removeEventListener("load",i);var c=r.naturalWidth*t.scale,l=r.naturalHeight*t.scale,s=new Ue.LatLngBounds([t.y_offset,t.x_offset],[t.y_offset-l,t.x_offset+c]);n[e.name]={level:e,imageUrl:o,bounds:s,trajectories:[]},a()}))})))},r.s();case 6:if((o=r.n()).done){t.next=12;break}if("continue"!==i()){t.next=10;break}return t.abrupt("continue",10);case 10:t.next=6;break;case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(3),r.e(t.t0);case 17:return t.prev=17,r.f(),t.finish(17);case 20:c=0,s=a;case 21:if(!(c<s.length)){t.next=28;break}return f=s[c],t.next=25,f;case 25:c++,t.next=21;break;case 28:u(n),_(vt(Object.values(n)));case 30:case"end":return t.stop()}}),t,null,[[3,14,17,20]])})))()}),[e.buildingMap,n]),r.a.useEffect((function(){var t,a=e.trajManager;if(E&&a)return Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=window.setInterval(Object(s.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.latestTrajectory({request:"trajectory",param:{map_name:E.level.name,duration:6e4,trim:!0}});case 2:t=e.sent,u((function(e){return Object(F.a)({},e,Object(z.a)({},E.level.name,Object(F.a)({},E,{trajectories:t.values})))}));case 4:case"end":return e.stop()}}),e)}))),L);case 1:case"end":return e.stop()}}),e)})))(),function(){return clearInterval(t)}}),[e.trajManager,E,D,L]);var M=f.map((function(e){return c[e]})),N=r.a.useRef(null);return N.current&&N.current.leafletElement.setZIndex(0),r.a.createElement(qe.a,{ref:a,className:t.map,attributionControl:!1,crs:Ue.CRS.Simple,minZoom:4,maxZoom:8,zoomDelta:.5,zoomSnap:.5,bounds:h,maxBounds:y,onbaselayerchange:function(e){v(e.name)}},r.a.createElement(Ge.a,{position:"bottomright",prefix:"OSRC-SG"}),r.a.createElement(Ve.a,{position:"topleft"},M.every((function(e){return e}))&&M.map((function(e,t){return r.a.createElement(Ve.a.BaseLayer,{checked:0===t,name:e.level.name,key:e.level.name},r.a.createElement(We.a,{bounds:e.bounds,url:e.imageUrl,ref:N}))})),r.a.createElement(Ve.a.Overlay,{name:"Places",checked:!0},E&&r.a.createElement(ze.a,null,r.a.createElement($e,{bounds:E.bounds,places:E.level.places,onPlaceClick:e.onPlaceClick}))),r.a.createElement(Ve.a.Overlay,{name:"Robot Trajectories",checked:!0},E&&r.a.createElement(ze.a,null,r.a.createElement(ct.Provider,{value:{Component:D}},r.a.createElement(it,{bounds:E.bounds,trajs:E.trajectories,colorManager:k})))),r.a.createElement(Ve.a.Overlay,{name:"Robots",checked:!0},E&&r.a.createElement(ze.a,null,r.a.createElement(ut,{bounds:E.bounds,robots:x,colorManager:k,onRobotClick:e.onRobotClick})))))}var ht=a(177),gt=a(188),Ot=a(189),yt=a(185),_t=a(178),wt=a(183);function xt(e){var t=St(),a=e.settings,n=e.onSettingsChange,o=Object(Y.a)(e,["settings","onSettingsChange"]),i=a.trajectoryAnimation,c=r.a.useMemo((function(){return Object.keys(j).slice(.5*Object.keys(j).length)}),[]);return r.a.createElement(ht.a,Object.assign({PaperProps:{className:t.drawer},anchor:"right"},o),r.a.createElement(gt.a,{component:"fieldset"},r.a.createElement(Ot.a,{component:"legend",className:t.legendLabel},"Trajectory Animation"),r.a.createElement(Z.a,null),r.a.createElement(yt.a,{className:t.trajGroup,value:i,onChange:function(e){var t=Object(F.a)({},a,{trajectoryAnimation:Number(e.target.value)});n&&n(t)}},c.map((function(e,a){return r.a.createElement(_t.a,{key:a,className:t.flexBasis,value:a,control:r.a.createElement(wt.a,null),label:e})})))))}var jt,St=Object(C.a)((function(e){return{drawer:{width:300},legendLabel:{fontSize:e.typography.h6.fontSize,padding:e.spacing(1)},trajGroup:{flexDirection:"row",paddingLeft:e.spacing(2)},flexBasis:{flexBasis:"40%"}}})),kt=Object(C.a)((function(e){return{container:{display:"flex",flexFlow:"column",height:"100%"},toolBarTitle:{flexGrow:1},omniPanel:{position:"fixed",width:350,top:80,right:"1%",bottom:"2%",backgroundColor:e.palette.background.default,zIndex:1024,borderTopLeftRadius:20,borderTopRightRadius:20,boxShadow:e.shadows[12]},topLeftBorder:{borderTopLeftRadius:20},topRightBorder:{borderTopRightRadius:20}}}));!function(e){e[e.MainMenu=0]="MainMenu",e[e.Doors=1]="Doors",e[e.Lifts=2]="Lifts",e[e.Robots=3]="Robots",e[e.Places=4]="Places",e[e.Dispensers=5]="Dispensers"}(jt||(jt={}));var Ct=function(){function e(t,a){Object(u.a)(this,e),this.value=t,this.parent=a}return Object(f.a)(e,[{key:"addChild",value:function(t){return new e(t,this)}}]),e}();var Lt=function(){var e={},t=new Ct(jt.MainMenu);return e[jt.MainMenu]=t,e[jt.Doors]=t.addChild(jt.Doors),e[jt.Lifts]=t.addChild(jt.Lifts),e[jt.Robots]=t.addChild(jt.Robots),e[jt.Places]=t.addChild(jt.Places),e[jt.Dispensers]=t.addChild(jt.Dispensers),e}();function Dt(e){var t=kt(),a=e.appConfig,n=a.transportFactory,o=a.trajectoryManagerFactory,i=r.a.useState(void 0),c=Object(w.a)(i,2),u=c[0],f=c[1],m=r.a.useState(void 0),d=Object(w.a)(m,2),p=d[0],b=d[1],v=r.a.useRef(void 0),h=r.a.useRef(r.a.useMemo((function(){return new T}),[])).current,O=r.a.useState({}),y=Object(w.a)(O,2),_=y[0],x=y[1],j=r.a.useState([]),S=Object(w.a)(j,2),k=S[0],C=S[1],F=r.a.useState(void 0),A=Object(w.a)(F,2),B=(A[0],A[1]),z=r.a.useRef(r.a.useMemo((function(){return new q}),[])).current,Y=r.a.useState({}),H=Object(w.a)(Y,2),J=H[0],K=H[1],Q=r.a.useState([]),Z=Object(w.a)(Q,2),X=Z[0],$=Z[1],ee=r.a.useState(void 0),te=Object(w.a)(ee,2),ae=(te[0],te[1]),re=r.a.useMemo((function(){return new U}),[]),oe=r.a.useState(re.fleets()),ie=Object(w.a)(oe,2),ce=ie[0],le=ie[1],se=r.a.useState(void 0),ue=Object(w.a)(se,2),fe=ue[0],me=ue[1],de=r.a.useState(void 0),be=Object(w.a)(de,2),ve=be[0],Ee=be[1],he=r.a.useRef(r.a.useMemo((function(){return new G}),[])).current,ge=r.a.useState({}),_e=Object(w.a)(ge,2),we=_e[0],xe=_e[1],Se=r.a.useState(void 0),ke=Object(w.a)(Se,2),Le=ke[0],De=ke[1],Me=r.a.useState(!0),Re=Object(w.a)(Me,2),Ie=Re[0],Fe=Re[1],Ae=r.a.useState(jt.MainMenu),Be=Object(w.a)(Ae,2),Ue=Be[0],qe=Be[1],Ge=r.a.useState({caption:"Connecting to SOSS..."}),Ve=Object(w.a)(Ge,2),We=Ve[0],ze=Ve[1],Ye=r.a.useState(!1),He=Object(w.a)(Ye,2),Je=He[0],Ke=He[1],Qe=r.a.useState((function(){return function(){var e=localStorage.getItem("settings");return e?JSON.parse(e):V()}()})),Ze=Object(w.a)(Qe,2),Xe=Ze[0],$e=Ze[1];function et(){B(void 0),ae(void 0),me(void 0),De(void 0)}function tt(){et(),Fe(!1)}return r.a.useEffect((function(){ze({caption:"Connecting to SOSS server..."}),n().then((function(e){e.on("error",console.error),e.once("close",(function(){ze({caption:"Lost connection to SOSS",variant:"error"}),f(void 0)})),h.startSubscription(e),z.startSubscription(e),he.startSubscription(e),re.startSubscription(e),re.on("updated",(function(){return le(re.fleets())})),f(e)})).catch((function(e){ze({caption:"Unable to connect to SOSS server (".concat(e.code,")"),variant:"error"})}))}),[n,h,z,he,re]),r.a.useEffect((function(){if(u){ze({caption:"Downloading building map..."});var e=new E.GetBuildingMap_Request;u.call(E.getBuildingMap,e).then((function(e){b(e.building_map),ze(null)})).catch((function(){ze({caption:"Unable to download building map",variant:"error"})}))}}),[u]),r.a.useEffect((function(){o&&Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:v.current=e.sent;case 3:case"end":return e.stop()}}),e)})))()}),[o]),r.a.useEffect((function(){if(Ue===jt.Doors){var e=function(){return x(h.doorStates())};return h.on("updated",e),g.a.log("started tracking door states"),function(){h.off("updated",e),g.a.log("stopped tracking door states")}}}),[Ue,h]),r.a.useEffect((function(){if(Ue===jt.Lifts){var e=function(){return K(z.liftStates())};return z.on("updated",e),g.a.log("started tracking lift states"),function(){z.off("updated",e),g.a.log("stopped tracking lift states")}}}),[Ue,z]),r.a.useEffect((function(){if(Ue===jt.Dispensers){var e=function(){return xe(he.dispenserStates())};return he.on("updated",e),g.a.log("started tracking dispenser states"),function(){he.off("updated",e),g.a.log("stopped tracking dispenser states")}}}),[Ue,he]),r.a.useEffect((function(){C(p?p.levels.flatMap((function(e){return e.doors})):[]),$(p?p.lifts:[])}),[p]),r.a.createElement(r.a.Fragment,null,r.a.createElement(W.Provider,{value:Xe},We&&r.a.createElement(Oe,We),r.a.createElement("div",{className:t.container},r.a.createElement(L.a,{position:"static"},r.a.createElement(D.a,null,r.a.createElement(M.a,{variant:"h6",className:t.toolBarTitle},"Dashboard"),r.a.createElement(N.a,{color:"inherit",onClick:function(){return Fe(!Ie)}},r.a.createElement(I.a,null)),r.a.createElement(N.a,{color:"inherit",onClick:function(){return Ke(!0)}},r.a.createElement(P.a,null)))),p&&r.a.createElement(Et,{buildingMap:p,fleets:ce,trajManager:v.current,onPlaceClick:function(e){Fe(!0),qe(jt.Places),Ee({value:e.name})},onRobotClick:function(e){Fe(!0),qe(jt.Robots),me({value:e.name})}}),r.a.createElement(R.a,{in:Ie},r.a.createElement(je,{className:t.omniPanel,classes:{backButton:t.topLeftBorder,closeButton:t.topRightBorder},view:Ue,onBack:function(e){et();var t=Lt[e].parent;if(!t)return tt();qe(t.value)},onClose:tt},r.a.createElement(Ce,{value:Ue,index:jt.MainMenu},r.a.createElement(ye,{onDoorsClick:function(){x(h.doorStates()),qe(jt.Doors)},onLiftsClick:function(){K(z.liftStates()),qe(jt.Lifts)},onRobotsClick:function(){qe(jt.Robots)},onPlacesClick:function(){qe(jt.Places)},onDispensersClick:function(){qe(jt.Dispensers)}})),r.a.createElement(Ce,{value:Ue,index:jt.Doors},r.a.createElement(ne,{transport:u,doorStates:_,doors:k})),r.a.createElement(Ce,{value:Ue,index:jt.Lifts},r.a.createElement(pe,{transport:u,liftStates:J,lifts:X})),r.a.createElement(Ce,{value:Ue,index:jt.Robots},r.a.createElement(Pe,{fleets:ce,spotlight:fe})),r.a.createElement(Ce,{value:Ue,index:jt.Places},p&&r.a.createElement(Ne,{buildingMap:p,spotlight:ve})),r.a.createElement(Ce,{value:Ue,index:jt.Dispensers},r.a.createElement(Te,{dispenserStates:we,spotlight:Le})))),r.a.createElement(xt,{settings:Xe,open:Je,onSettingsChange:function(e){$e(e),function(e){localStorage.setItem("settings",JSON.stringify(e))}(e)},onClose:function(){return Ke(!1)}}))))}a(124);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));!function(){var e=Ue.Map.prototype._initControlPos;Ue.Map.include({_initControlPos:function(){e.call(this),this._controlCorners.topcenter=Ue.DomUtil.create("div","leaflet-top leaflet-horizontal-center",this._controlContainer),this._controlCorners.bottomcenter=Ue.DomUtil.create("div","leaflet-bottom leaflet-horizontal-center",this._controlContainer),this._controlCorners.leftcenter=Ue.DomUtil.create("div","leaflet-left leaflet-vertical-center",this._controlContainer),this._controlCorners.rightcenter=Ue.DomUtil.create("div","leaflet-right leaflet-vertical-center",this._controlContainer),this._controlCorners.center=Ue.DomUtil.create("div","leaflet-horizontal-center leaflet-vertical-center",this._controlContainer)}})}(),i.a.render(r.a.createElement(Dt,{appConfig:k}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},83:function(e){e.exports=JSON.parse('{"response":"trajectory","values":[{"dimensions":0.3,"id":23,"segments":[{"t":-500,"v":[0,0,0],"x":[15.157189278566513,-11.22709173117512,-1.561402678489685]},{"t":-60,"v":[0,0,-2.2],"x":[15.157189278566513,-11.22709173117512,-2.045402678489685]},{"t":199,"v":[0,0,-2.2],"x":[15.157189278566513,-11.22709173117512,-2.617109907596058]},{"t":639,"v":[0,0,0],"x":[15.157189278566513,-11.22709173117512,-3.1011099075960584]},{"t":2909,"v":[0.3996722742168869,0.01618867574267909,0],"x":[15.183834096847638,-11.226012486125608,-3.1011099075960584]},{"t":11924,"v":[0.3996722742168869,0.01618867574267909,0],"x":[18.78719805652494,-11.080058677244644,-3.1011099075960584]},{"t":12058,"v":[0,0,0],"x":[18.813842874806067,-11.078979432195132,-3.1011099075960584]},{"t":12498,"v":[0,0,2.2],"x":[18.813842874806067,-11.078979432195132,-2.6171099075960584]},{"t":12766,"v":[0,0,2.2],"x":[18.813842874806067,-11.078979432195132,-2.027318669919959]},{"t":13206,"v":[0,0,0],"x":[18.813842874806067,-11.078979432195132,-1.5433186699199588]},{"t":13339,"v":[-0.010989679720506256,0.3998490051752545,0],"x":[18.813110229491368,-11.052322831850114,-1.5433186699199588]},{"t":14973,"v":[-0.010989679720506256,0.3998490051752545,0],"x":[18.795155674792685,-10.399063499711813,-1.5433186699199588]},{"t":15106,"v":[0,0,0],"x":[18.794423029477986,-10.372406899366796,-1.5433186699199588]},{"t":15546,"v":[0,0,-2.2],"x":[18.794423029477986,-10.372406899366796,-2.027318669919959]},{"t":15820,"v":[0,0,-2.2],"x":[18.794423029477986,-10.372406899366796,-2.6285350876658105]},{"t":16260,"v":[0,0,0],"x":[18.794423029477986,-10.372406899366796,-3.1125350876658104]},{"t":20260,"v":[0,0,0],"x":[18.794423029477986,-10.372406899366796,-3.1125350876658104]},{"t":20393,"v":[0.39983114345407433,0.011621390803488767,0],"x":[18.821078439041592,-10.371632139979896,-3.1125350876658104]},{"t":25281,"v":[0.39983114345407433,0.011621390803488767,0],"x":[20.775376669280053,-10.314829002325423,-3.1125350876658104]},{"t":25414,"v":[0,0,0],"x":[20.80203207884366,-10.314054242938523,-3.1125350876658104]},{"t":29414,"v":[0,0,0],"x":[20.80203207884366,-10.314054242938523,-3.1125350876658104]},{"t":29854,"v":[0,0,2.2],"x":[20.80203207884366,-10.314054242938523,-2.6285350876658105]},{"t":30091,"v":[0,0,2.2],"x":[20.80203207884366,-10.314054242938523,-2.106660043966393]},{"t":30531,"v":[0,0,0],"x":[20.80203207884366,-10.314054242938523,-1.622660043966393]},{"t":30665,"v":[0.020736187761440938,0.3994621515452024,0],"x":[20.80341449136109,-10.28742343283551,-1.622660043966393]},{"t":37583,"v":[0.020736187761440938,0.3994621515452024,0],"x":[20.946865694445933,-7.523977861968549,-1.622660043966393]},{"t":37716,"v":[0,0,0],"x":[20.948248106963362,-7.497347051865536,-1.622660043966393]}],"shape":"circle"}]}')},84:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return u}));var n=a(7),r=a.n(n),o=a(15),i=a(85),c=a.n(i),l=a(86),s=a.n(l);function u(){return f.apply(this,arguments)}function f(){return(f=Object(o.a)(r.a.mark((function t(){var a,n,o,i,l,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.next=8;break;case 3:o=t.sent,a=o.readFileSync("".concat(e,"/office.png")),n=o.readFileSync("".concat(e,"/airport_terminal.png")),t.next=24;break;case 8:return t.next=10,fetch(s.a);case 10:return i=t.sent,t.t0=Uint8Array,t.next=14,i.arrayBuffer();case 14:return t.t1=t.sent,a=new t.t0(t.t1),t.next=18,fetch(c.a);case 18:return l=t.sent,t.t2=Uint8Array,t.next=22,l.arrayBuffer();case 22:t.t3=t.sent,n=new t.t2(t.t3);case 24:return u=[{name:"main_door",v1_x:7,v1_y:-6,v2_x:8,v2_y:-6.2,door_type:1,motion_range:1.571,motion_direction:1},{name:"hardware_door",v1_x:4,v1_y:-4,v2_x:4.1,v2_y:-3.8,door_type:1,motion_range:1.571,motion_direction:-1},{name:"coe_door",v1_x:6,v1_y:-6,v2_x:6.2,v2_y:-5.9,door_type:2,motion_range:-1.571,motion_direction:1}],t.abrupt("return",{name:"test building",levels:[{name:"L1",elevation:0,images:[{data:a,encoding:"png",name:"office",scale:.008465494960546494,x_offset:0,y_offset:0,yaw:0}],places:[{name:"Place1",x:2,y:-2,yaw:0,position_tolerance:0,yaw_tolerance:0},{name:"Place2",x:8,y:-4,yaw:0,position_tolerance:0,yaw_tolerance:0}],doors:u,nav_graphs:[],wall_graph:{name:"wallgraph",vertices:[],edges:[],params:[]}},{name:"Airport Terminal",elevation:10,doors:[],images:[{data:n,encoding:"png",name:"airport_terminal",scale:.08212187141180038,x_offset:0,y_offset:0,yaw:0}],nav_graphs:[],places:[],wall_graph:{name:"wallgraph",vertices:[],edges:[],params:[]}}],lifts:[{name:"Lift1",doors:[],levels:["L1","L2","L3"],ref_x:0,ref_y:0,ref_yaw:0,wall_graph:{name:"wallgraph",vertices:[],edges:[],params:[]}},{name:"Lift2",doors:[],levels:["L1","L2","L3","L4"],ref_x:10,ref_y:10,ref_yaw:1.571,wall_graph:{name:"wallgraph",vertices:[],edges:[],params:[]}},{name:"mysterious_lift",doors:[],levels:["L1","L2","L3","L4"],ref_x:10,ref_y:10,ref_yaw:1.571,wall_graph:{name:"wallgraph",vertices:[],edges:[],params:[]}}]});case 26:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}).call(this,"/")},85:function(e,t,a){e.exports=a.p+"static/media/airport_terminal.f7ab7134.png"},86:function(e,t,a){e.exports=a.p+"static/media/office.73533f75.png"},96:function(e,t,a){e.exports=a(125)}},[[96,1,2]]]);
//# sourceMappingURL=main.44c022a6.chunk.js.map